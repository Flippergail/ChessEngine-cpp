#pragma once

#include <iostream>
#include <vector>

#include <chrono>
using namespace std::chrono;

#include "../Board/Board.h"
#include "../Board/Move.h"

class Engine {
public:
	int engineColour{};

	void make_move(Board& board);

private:
	int tree_leaves {};
	int total_branches{};

	const int treeDepth{ 4 };
	const int quiescenceDepth{ 6 };
	bool move_repeating{ false };

	// quiescence search delta pruning
	int BIG_DELTA = 975;

	int negamax(Board& board, int alpha, int beta, int treeDepthLeft);
	int quiescence(Board& board, int alpha, int beta, int treeDepthLeft);

	int evaluatePosition(Board& board);
	int actual_weight(Board& board);
	int rough_position_weight(Board& board);


	const int black_pawn_table[8][8] = {
		{0, 0, 0, 0, 0, 0, 0, 0},
		{5, 10, 10, -20, -20, 10, 10, 5},
		{5, -5, -10, 0, 0, -10, -5, 5},
		{0, 0, 0, 20, 20, 0, 0, 0},
		{5, 5, 10, 25, 25, 10, 5, 5},
		{10, 10, 20, 30, 30, 20, 10, 10},
		{50, 50, 50, 50, 50, 50, 50, 50},
		{0, 0, 0, 0, 0, 0, 0, 0} 
	};

	const int white_pawn_table[8][8] = {
		{0, 0, 0, 0, 0, 0, 0, 0},
		{50, 50, 50, 50, 50, 50, 50, 50},
		{10, 10, 20, 30, 30, 20, 10, 10},
		{5, 5, 10, 25, 25, 10, 5, 5},
		{0, 0, 0, 20, 20, 0, 0, 0},
		{5, -5, -10, 0, 0, -10, -5, 5},
		{5, 10, 10, -20, -20, 10, 10, 5},
		{0, 0, 0, 0, 0, 0, 0, 0}
	};


	const int black_knights_table[8][8] = {
		{-50, -40, -30, -30, -30, -30, -40, -50 },
		{-40, -20, 0, 5, 5, 0, -20, -40 },
		{-30, 5, 10, 15, 15, 10, 5, -30 },
		{-30, 0, 15, 20, 20, 15, 0, -30 },
		{-30, 5, 15, 20, 20, 15, 5, -30 },
		{-30, 0, 10, 15, 15, 10, 0, -30 },
		{-40, -20, 0, 0, 0, 0, -20, -40 },
		{-50, -40, -30, -30, -30, -30, -40, -50 } 
	};

	const int white_knights_table[8][8] = {
		{-50, -40, -30, -30, -30, -30, -40, -50 },
		{-40, -20, 0, 0, 0, 0, -20, -40 },
		{-30, 0, 10, 15, 15, 10, 0, -30 },
		{-30, 5, 15, 20, 20, 15, 5, -30 },
		{-30, 0, 15, 20, 20, 15, 0, -30 },
		{-30, 5, 10, 15, 15, 10, 5, -30 },
		{-40, -20, 0, 5, 5, 0, -20, -40 },
		{-50, -40, -30, -30, -30, -30, -40, -50 }
	};


	const int black_bishops_table[8][8] = {
		{-20, -10, -10, -10, -10, -10, -10, -20 },
		{-10, 5, 0, 0, 0, 0, 5, -10},
		{-10, 10, 10, 10, 10, 10, 10, -10},
		{-10, 0, 10, 10, 10, 10, 0, -10},
		{-10, 5, 5, 10, 10, 5, 5, -10},
		{-10, 0, 5, 10, 10, 5, 0, -10},
		{-10, 0, 0, 0, 0, 0, 0, -10},
		{-20, -10, -10, -10, -10, -10, -10, -20 } 
	};

	const int white_bishops_table[8][8] = {
		{-20, -10, -10, -10, -10, -10, -10, -20 },
		{-10, 0, 0, 0, 0, 0, 0, -10},
		{-10, 0, 5, 10, 10, 5, 0, -10},
		{-10, 5, 5, 10, 10, 5, 5, -10},
		{-10, 0, 10, 10, 10, 10, 0, -10},
		{-10, 10, 10, 10, 10, 10, 10, -10},
		{-10, 5, 0, 0, 0, 0, 5, -10},
		{-20, -10, -10, -10, -10, -10, -10, -20 }
	};


	const int black_rooks_table[8][8] = {
		{0, 0, 0, 5, 5, 0, 0, 0 },
		{-5, 0, 0, 0, 0, 0, 0, -5 },
		{-5, 0, 0, 0, 0, 0, 0, -5 },
		{-5, 0, 0, 0, 0, 0, 0, -5 },
		{-5, 0, 0, 0, 0, 0, 0, -5 },
		{-5, 0, 0, 0, 0, 0, 0, -5 },
		{5, 10, 10, 10, 10, 10, 10, 5 },
		{0, 0, 0, 0, 0, 0, 0, 0 } };

	const int white_rooks_table[8][8] = {
		{0, 0, 0, 0, 0, 0, 0, 0 },
		{5, 10, 10, 10, 10, 10, 10, 5 }, 
		{-5, 0, 0, 0, 0, 0, 0, -5 }, 
		{-5, 0, 0, 0, 0, 0, 0, -5 }, 
		{-5, 0, 0, 0, 0, 0, 0, -5 }, 
		{-5, 0, 0, 0, 0, 0, 0, -5 }, 
		{-5, 0, 0, 0, 0, 0, 0, -5 },
		{0, 0, 0, 5, 5, 0, 0, 0 }
	};


	const int black_queens_table[8][8] = {
		{-20, -10, -10, -5, -5, -10, -10, -20 },
		{-10, 0, 0, 0, 0, 0, 0, -10},
		{-10, 5, 5, 5, 5, 5, 0, -10},
		{0, 0, 5, 5, 5, 5, 0, -5},
		{-5, 0, 5, 5, 5, 5, 0, -5},
		{-10, 0, 5, 5, 5, 5, 0, -10},
		{-10, 0, 0, 0, 0, 0, 0, -10},
		{ -20, -10, -10, -5, -5, -10, -10, -20} };

	const int white_queens_table[8][8] = {
		{-20, -10, -10, -5, -5, -10, -10, -20 },
		{-10, 0, 0, 0, 0, 0, 0, -10}, 
		{-10, 0, 5, 5, 5, 5, 0, -10}, 
		{-5, 0, 5, 5, 5, 5, 0, -5}, 
		{0, 0, 5, 5, 5, 5, 0, -5}, 
		{-10, 5, 5, 5, 5, 5, 0, -10}, 
		{-10, 0, 0, 0, 0, 0, 0, -10}, 
		{-20, -10, -10, -5, -5, -10, -10, -20 }
	};


	const int black_kings_table[8][8] = {
		{20, 30, 10, 0, 0, 10, 30, 20 },
		{20, 20, 0, 0, 0, 0, 20, 20},
		{-10, -20, -20, -20, -20, -20, -20, -10},
		{-20, -30, -30, -40, -40, -30, -30, -20},
		{-30, -40, -40, -50, -50, -40, -40, -30},
		{-30, -40, -40, -50, -50, -40, -40, -30},
		{-30, -40, -40, -50, -50, -40, -40, -30},
		{-30, -40, -40, -50, -50, -40, -40, -30 }
	};

	const int white_kings_table[8][8] = {
		{-30, -40, -40, -50, -50, -40, -40, -30 },
		{-30, -40, -40, -50, -50, -40, -40, -30},
		{-30, -40, -40, -50, -50, -40, -40, -30},
		{-30, -40, -40, -50, -50, -40, -40, -30},
		{-20, -30, -30, -40, -40, -30, -30, -20},
		{-10, -20, -20, -20, -20, -20, -20, -10},
		{20, 20, 0, 0, 0, 0, 20, 20},
		{20, 30, 10, 0, 0, 10, 30, 20 },
	};
};